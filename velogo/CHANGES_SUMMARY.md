# –ó–≤–µ–¥–µ–Ω–Ω—è –∑–º—ñ–Ω –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ —Ç–∞ –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è –º–∞—Ä—à—Ä—É—Ç—ñ–≤

## üìã –ó–∞–≥–∞–ª—å–Ω–∏–π —Å–ø–∏—Å–æ–∫ –∑–º—ñ–Ω

### 1. –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–µ—Ä—à–æ–≥–æ —Ç–∞–ø—É –Ω–∞ –∫–∞—Ä—Ç—É
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –ø–µ—Ä—à–æ–º—É —Ç–∞–ø—ñ –Ω–∞ –∫–∞—Ä—Ç—É –Ω–µ –∑'—è–≤–ª—è—î—Ç—å—Å—è –ø–æ—á–∞—Ç–∫–æ–≤–∞ —Ç–æ—á–∫–∞/–º–∞—Ä–∫–µ—Ä.

**–†—ñ—à–µ–Ω–Ω—è:**
- –ü—Ä–∏ –ø–µ—Ä—à–æ–º—É —Ç–∞–ø—ñ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –ø–æ—á–∞—Ç–∫–æ–≤—É —Ç–æ—á–∫—É/–º–∞—Ä–∫–µ—Ä –Ω–∞–≤—ñ—Ç—å –±–µ–∑ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –º–∞—Ä—à—Ä—É—Ç—É
- –ó–±–µ—Ä—ñ–≥–∞—Ç–∏ `_lastPoint` –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑'—î–¥–Ω–∞–Ω–Ω—è

**–§–∞–π–ª–∏ –¥–ª—è –∑–º—ñ–Ω:**
- `lib/features/map/presentation/pages/create_route_screen.dart` - –º–µ—Ç–æ–¥ `_addRoutePoint()`

---

### 2. –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É elevationGain —Ç–∞ windEffect –≤ —Å–µ—Ä–≤—ñ—Å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
**–ü—Ä–æ–±–ª–µ–º–∞:** `elevationGain` —Ç–∞ `windEffect` —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—é—Ç—å—Å—è –æ–∫—Ä–µ–º–æ –≤ `_addRoutePoint()` —ñ –Ω–µ –≤—Ä–∞—Ö–æ–≤—É—é—Ç—å —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

**–†—ñ—à–µ–Ω–Ω—è:**
- –í–∏–¥–∞–ª–∏—Ç–∏ –æ–∫—Ä–µ–º—ñ –≤–∏–∫–ª–∏–∫–∏ `CalculateElevationGainUseCase` —Ç–∞ `CalculateWindEffectUseCase` –∑ `_addRoutePoint()`
- –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤ —Å–µ—Ä–≤—ñ—Å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ –∞–±–æ –æ–∫—Ä–µ–º–∏–π Use Case –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Å–µ–∫—Ü—ñ—ó
- –í—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø—Ä–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É

**–§–∞–π–ª–∏ –¥–ª—è –∑–º—ñ–Ω:**
- `lib/features/map/presentation/pages/create_route_screen.dart` - –º–µ—Ç–æ–¥ `_addRoutePoint()`
- `lib/core/services/route_complexity_service.dart` - –¥–æ–¥–∞—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ elevationGain —Ç–∞ windEffect
- –ê–±–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π Use Case: `CalculateSectionParametersUseCase`

---

### 3. –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ difficulty, averageSpeed, surfaceType –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** `difficulty`, `averageSpeed`, `surfaceType` –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—Ç—å—Å—è —Å—Ç–∞—Ç–∏—á–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ (`0.0`, `15.0`, `asphalt`) —ñ –Ω–µ —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—é—Ç—å—Å—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–µ–∞–ª—å–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤.

**–†—ñ—à–µ–Ω–Ω—è:**
- –†–æ–∑—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ `difficulty` –Ω–∞ –æ—Å–Ω–æ–≤—ñ `elevationGain`, `windEffect`, `surfaceType` + —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ
- –†–æ–∑—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ `averageSpeed` –Ω–∞ –æ—Å–Ω–æ–≤—ñ `difficulty`, `surfaceType`, –ø—Ä–æ—Ñ—ñ–ª—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- –í–∏–∑–Ω–∞—á–∞—Ç–∏ `surfaceType` –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (–∑ API –∞–±–æ –∫–∞—Ä—Ç)

**–§–∞–π–ª–∏ –¥–ª—è –∑–º—ñ–Ω:**
- `lib/core/services/route_complexity_service.dart` - –¥–æ–¥–∞—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤—Å—ñ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Å–µ–∫—Ü—ñ—ó
- –ê–±–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π Use Case: `CalculateSectionParametersUseCase`

---

### 4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Ä–æ–∑–±–∏—Ç—Ç—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤—ñ–¥ API –Ω–∞ —Å–µ–∫—Ü—ñ—ó
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú—ñ–∂ –¥–≤–æ–º–∞ –ø–æ—ñ–Ω—Ç–∞–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –æ–¥–Ω–∞ —Å–µ–∫—Ü—ñ—è, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –º–∞—Ä—à—Ä—É—Ç –º–∞—î —Ä—ñ–∑–Ω—ñ –ø—ñ–¥–π–æ–º–∏, —Å–ø—É—Å–∫–∏, —Ç–∏–ø–∏ –ø–æ–∫—Ä–∏—Ç—Ç—è.

**–†—ñ—à–µ–Ω–Ω—è:**
- –°—Ç–≤–æ—Ä–∏—Ç–∏ —Å–µ—Ä–≤—ñ—Å/–º–µ—Ç–æ–¥ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Ä–æ–∑–±–∏—Ç—Ç—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤—ñ–¥ API –Ω–∞ –ø—ñ–¥—Å–µ–∫—Ü—ñ—ó
- –ö—Ä–∏—Ç–µ—Ä—ñ—ó —Ä–æ–∑–±–∏—Ç—Ç—è:
  - –§—ñ–∫—Å–æ–≤–∞–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞: 300-500 –º–µ—Ç—Ä—ñ–≤
  - –ó–º—ñ–Ω–∞ –Ω–∞–ø—Ä—è–º—É –¥–æ—Ä–æ–≥–∏ (–∑–Ω–∞—á–Ω–∏–π –∫—É—Ç –ø–æ–≤–æ—Ä–æ—Ç—É)
  - –ó–º—ñ–Ω–∞ –≤–∏—Å–æ—Ç–∏: –ø–æ—Ä—ñ–≥ 30-50 –º
  - –ó–º—ñ–Ω–∞ —Ç–∏–ø—É –ø–æ–∫—Ä–∏—Ç—Ç—è (—è–∫—â–æ –¥–æ—Å—Ç—É–ø–Ω–æ)
  - –ó–º—ñ–Ω–∞ –Ω–∞–ø—Ä—è–º–∫—É –≤—ñ—Ç—Ä—É

**–§–∞–π–ª–∏ –¥–ª—è –∑–º—ñ–Ω:**
- –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π —Å–µ—Ä–≤—ñ—Å: `lib/core/services/route_segmentation_service.dart`
- –ê–±–æ –¥–æ–¥–∞—Ç–∏ –º–µ—Ç–æ–¥ –≤ `RoadRoutingService`: `splitRouteIntoSections()`
- `lib/features/map/presentation/pages/create_route_screen.dart` - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ä–æ–∑–±–∏—Ç—Ç—è –ø–µ—Ä–µ–¥ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è–º —Å–µ–∫—Ü—ñ–π

---

### 5. –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ –¥–ª—è –∫–æ–∂–Ω–æ—ó —Å–µ–∫—Ü—ñ—ó –æ–∫—Ä–µ–º–æ
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤—Å—å–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç—É –ø—ñ—Å–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö —Å–µ–∫—Ü—ñ–π, –∞ –Ω–µ –¥–ª—è –æ–∫—Ä–µ–º–∏—Ö —Å–µ–∫—Ü—ñ–π.

**–†—ñ—à–µ–Ω–Ω—è:**
- –†–æ–∑—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –¥–ª—è –∫–æ–∂–Ω–æ—ó —Å–µ–∫—Ü—ñ—ó –æ–∫—Ä–µ–º–æ –ø–µ—Ä–µ–¥ –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º –¥–æ `_sections`
- –û–Ω–æ–≤–ª—é–≤–∞—Ç–∏ `setState()` —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –≤—Å—ñ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Å–µ–∫—Ü—ñ—ó
- –í–∏–¥–∞–ª–∏—Ç–∏ –≤–∏–∫–ª–∏–∫ `_calculateRouteDifficulty()` –ø—ñ—Å–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Å–µ–∫—Ü—ñ—ó

**–§–∞–π–ª–∏ –¥–ª—è –∑–º—ñ–Ω:**
- `lib/features/map/presentation/pages/create_route_screen.dart` - –º–µ—Ç–æ–¥ `_addRoutePoint()`
- –°—Ç–≤–æ—Ä–∏—Ç–∏ –º–µ—Ç–æ–¥ `_calculateSectionParameters()` –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –≤—Å—ñ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Å–µ–∫—Ü—ñ—ó

---

### 6. –ù–æ–≤–∞ –ª–æ–≥—ñ–∫–∞ –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è –º–∞—Ä—à—Ä—É—Ç—É
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Ç–æ—á–Ω–∞ –ª–æ–≥—ñ–∫–∞ –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–æ–≤–∏–º –≤–∏–º–æ–≥–∞–º (–±–∞–≥–∞—Ç–æ —Å–µ–∫—Ü—ñ–π, –ø–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ).

**–†—ñ—à–µ–Ω–Ω—è:**
- –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ `GestureDetector` –∑ `onLongPress` + `onPanUpdate`
- **–ñ–µ—Å—Ç:** –¢–∞–ø –Ω–∞ –º–∞—Ä—à—Ä—É—Ç ‚Üí –∑–∞—Ç—Ä–∏–º–∫–∞ ‚Üí –ø–æ—Ç—è–≥–Ω—É–≤
- **–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è:** –ù–ï –º–∞–ª—é–≤–∞—Ç–∏ –ø—Ä–æ—Ü–µ—Å –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
- **–ü–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫:** –ö–æ–ª–∏ –ø–∞–ª–µ—Ü—å –¥–æ—Ö–æ–¥–∏—Ç—å –¥–æ —Ç–æ—á–∫–∏ –Ω–∞ –¥–æ—Ä–æ–∑—ñ/—Ç—Ä–æ–ø—ñ–Ω—Ü—ñ:
  - –í–∏–∑–Ω–∞—á–∏—Ç–∏ –¥–≤—ñ –∫–ª—é—á–æ–≤—ñ —Ç–æ—á–∫–∏ –º–∞—Ä—à—Ä—É—Ç—É (—è–∫—ñ –Ω–µ –∑–º—ñ–Ω—é–≤–∞–ª–∏—Å—è)
  - –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –≤—ñ–¥—Ä—ñ–∑–æ–∫ –º–∞—Ä—à—Ä—É—Ç—É –º—ñ–∂ —Ü–∏–º–∏ —Ç–æ—á–∫–∞–º–∏ —á–µ—Ä–µ–∑ –Ω–æ–≤—É –ø–æ–∑–∏—Ü—ñ—é
  - –ü–µ—Ä–µ—Å—Ç–≤–æ—Ä–∏—Ç–∏ —Å–µ–∫—Ü—ñ—ó –≤ —Ü—å–æ–º—É –≤—ñ–¥—Ä—ñ–∑–∫—É
  - –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –¥–ª—è –Ω–æ–≤–∏—Ö —Å–µ–∫—Ü—ñ–π
- **–ü—ñ—Å–ª—è –≤—ñ–¥–ø—É—Å–∫–∞–Ω–Ω—è:** –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –∑–∞–≥–∞–ª—å–Ω—É —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –º–∞—Ä—à—Ä—É—Ç—É
- **–ö–∞—Å–∫–∞–¥–Ω–µ –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è:** –ù–∞–π–±–ª–∏–∂—á–∞ –¥–æ –ø–æ—á–∞—Ç–∫—É –∂–µ—Å—Ç—É + —Å—É—Å—ñ–¥–Ω—ñ —Å–µ–∫—Ü—ñ—ó
- **–ü–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫:** –¢—ñ–ª—å–∫–∏ –∑–º—ñ–Ω–µ–Ω–∏—Ö —Å–µ–∫—Ü—ñ–π (–∫—ñ–ª—å–∫—ñ—Å—Ç—å –º–æ–∂–µ –∑–º—ñ–Ω–∏—Ç–∏—Å—è)
- **–ú–µ—Ö–∞–Ω—ñ–∑–º –ø—Ä–∞–≤–∏–ª:** –ó–∞–∫–ª–∞—Å—Ç–∏ –º–µ—Ö–∞–Ω—ñ–∑–º –ø—Ä–∞–≤–∏–ª –ø–µ—Ä–µ—Ä–∞—Ö—É–Ω–∫—É (–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞ - –æ–∫—Ä–µ–º–æ –æ–±–¥—É–º–∞—Ç–∏)
- **–Ø–∫–æ—Ä—ñ-–º—ñ—Ç–∫–∏:** –ó–∞–∫–ª–∞—Å—Ç–∏ –º–µ—Ö–∞–Ω—ñ–∑–º —è–∫–æ—Ä—ñ–≤ (–¥–µ—Ç–∞–ª—ñ - –æ–∫—Ä–µ–º–æ –æ–±–¥—É–º–∞—Ç–∏)

**–§–∞–π–ª–∏ –¥–ª—è –∑–º—ñ–Ω:**
- `lib/features/map/presentation/pages/create_route_screen.dart` - –ø–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ –ª–æ–≥—ñ–∫—É –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è
- –í–∏–¥–∞–ª–∏—Ç–∏/–ø–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ –º–µ—Ç–æ–¥–∏:
  - `_handleLongPressOnRoute()`
  - `_handleSegmentDrag()`
  - `_moveRouteSection()`
  - `_findNearestSegment()`
- –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—ñ –º–µ—Ç–æ–¥–∏:
  - `_handleRouteDrag()` - –æ–±—Ä–æ–±–∫–∞ –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è
  - `_recalculateRouteSegment()` - –ø–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫ –≤—ñ–¥—Ä—ñ–∑–∫–∞ –º–∞—Ä—à—Ä—É—Ç—É
  - `_findKeyPoints()` - –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –∫–ª—é—á–æ–≤–∏—Ö —Ç–æ—á–æ–∫ –º–∞—Ä—à—Ä—É—Ç—É
  - `_snapToRoad()` - –ø—Ä–∏–ª–∏–ø–∞–Ω–Ω—è –¥–æ –¥–æ—Ä–æ–≥–∏

---

### 7. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è Use Case –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Å–µ–∫—Ü—ñ—ó
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ —Å–µ–∫—Ü—ñ—ó —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—é—Ç—å—Å—è –≤ —Ä—ñ–∑–Ω–∏—Ö –º—ñ—Å—Ü—è—Ö —ñ –Ω–µ –≤—Ä–∞—Ö–æ–≤—É—é—Ç—å —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ.

**–†—ñ—à–µ–Ω–Ω—è:**
- –°—Ç–≤–æ—Ä–∏—Ç–∏ `CalculateSectionParametersUseCase` —è–∫–∏–π –ø–æ–≤–µ—Ä—Ç–∞—î –≤—Å—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Å–µ–∫—Ü—ñ—ó:
  - `elevationGain`
  - `windEffect`
  - `surfaceType`
  - `difficulty`
  - `averageSpeed`
- –í—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤ `_addRoutePoint()` —Ç–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—ñ

**–§–∞–π–ª–∏ –¥–ª—è –∑–º—ñ–Ω:**
- –°—Ç–≤–æ—Ä–∏—Ç–∏: `lib/features/map/domain/usecases/calculate_section_parameters_usecase.dart`
- –°—Ç–≤–æ—Ä–∏—Ç–∏ Repository –º–µ—Ç–æ–¥: `calculateSectionParameters()`
- –°—Ç–≤–æ—Ä–∏—Ç–∏ RepositoryImpl: `calculateSectionParameters()`
- –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ –≤ DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ

---

### 8. –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –º–∞—Ä—à—Ä—É—Ç—É –∑ –≥—Ä–∞–¥—ñ—î–Ω—Ç–æ–º –∫–æ–ª—å–æ—Ä—É
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–∞—Ä—à—Ä—É—Ç –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –æ–¥–Ω–∏–º –∫–æ–ª—å–æ—Ä–æ–º –¥–ª—è –≤—Å—ñ—î—ó —Å–µ–∫—Ü—ñ—ó.

**–†—ñ—à–µ–Ω–Ω—è:**
- –í—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ –∫–æ–∂–Ω—É —Å–µ–∫—Ü—ñ—é –∑ –∫–æ–ª—å–æ—Ä–æ–º –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
- –î–æ–¥–∞—Ç–∏ –≥—Ä–∞–¥—ñ—î–Ω—Ç –∫–æ–ª—å–æ—Ä—É –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥—É –º—ñ–∂ —Å–µ–∫—Ü—ñ—è–º–∏

**–§–∞–π–ª–∏ –¥–ª—è –∑–º—ñ–Ω:**
- `lib/features/map/presentation/pages/create_route_screen.dart` - –º–µ—Ç–æ–¥ `_generatePolylines()`
- –ú–æ–∂–ª–∏–≤–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ `Polyline` –∑ –≥—Ä–∞–¥—ñ—î–Ω—Ç–æ–º –∞–±–æ –æ–∫—Ä–µ–º—ñ –ø–æ–ª—ñ–ª—ñ–Ω—ñ—ó –¥–ª—è –∫–æ–∂–Ω–æ—ó —Å–µ–∫—Ü—ñ—ó

---

## üìù –ù–∞ –º–∞–π–±—É—Ç–Ω—î (–Ω–µ –≤ —Ü—å–æ–º—É –µ—Ç–∞–ø—ñ)

### 9. –†—ñ–∑–Ω—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –ø–æ–±—É–¥–æ–≤–∏ –º–∞—Ä—à—Ä—É—Ç—ñ–≤
- –í—ñ–¥ –ø–æ—Ç–æ—á–Ω–æ—ó –ª–æ–∫–∞—Ü—ñ—ó –¥–æ –±–∞–∂–∞–Ω–æ—ó –≥–µ–æ–º—ñ—Ç–∫–∏
- –ü–æ –Ω–∞–∑–≤—ñ –º—ñ—Å—Ü—è
- –ü–æ —Ç–∞–ø—É –Ω–∞ –∫–∞—Ä—Ç—É
- –ó –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –≤–∏–±–æ—Ä–æ–º —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ –º–∞—Ä—à—Ä—É—Ç—É
- –ó –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –ª–æ–∫–∞—Ü—ñ–π –±—ñ–ª—è –º–∞—Ä—à—Ä—É—Ç—É

### 10. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ—Ä–∞—Ö—É–Ω–∫—É –º–∞—Ä—à—Ä—É—Ç—É
- –Ø–∫—â–æ –¥–æ—â ‚Üí —Ç—ñ–ª—å–∫–∏ –∞—Å—Ñ–∞–ª—å—Ç
- –Ü–Ω—à—ñ —É–º–æ–≤–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ–≥–æ–¥–∏, —Ç–∏–ø—É –ø–æ–∫—Ä–∏—Ç—Ç—è —Ç–æ—â–æ

### 11. –î–µ—Ç–∞–ª—ñ —Ä–æ–±–æ—Ç–∏ —è–∫–æ—Ä—ñ–≤-–º—ñ—Ç–æ–∫
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ/—Ä—É—á–Ω—ñ —è–∫–æ—Ä—ñ
- –¢–∏–ø–∏ –æ–±–º–µ–∂–µ–Ω—å (–º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –∑–º—ñ–Ω–∞, –Ω–∞–π–∫–æ—Ä–æ—Ç—à–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å, —Ç—ñ–ª—å–∫–∏ –∞—Å—Ñ–∞–ª—å—Ç/—Ç—ñ–ª—å–∫–∏ –≥—Ä—É–Ω—Ç)

---

## üîÑ –ü–æ—Ä—è–¥–æ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–º—ñ–Ω

### –ï—Ç–∞–ø 1: –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏
1. –°—Ç–≤–æ—Ä–∏—Ç–∏ `RouteSegmentationService` –¥–ª—è —Ä–æ–∑–±–∏—Ç—Ç—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –Ω–∞ —Å–µ–∫—Ü—ñ—ó
2. –°—Ç–≤–æ—Ä–∏—Ç–∏ `CalculateSectionParametersUseCase` –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Å–µ–∫—Ü—ñ—ó
3. –†–æ–∑—à–∏—Ä–∏—Ç–∏ `RouteComplexityService` –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –≤—Å—ñ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Å–µ–∫—Ü—ñ—ó

### –ï—Ç–∞–ø 2: –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–±—É–¥–æ–≤–∏ –º–∞—Ä—à—Ä—É—Ç—É
4. –í–∏–ø—Ä–∞–≤–∏—Ç–∏ –ø–µ—Ä—à–∏–π —Ç–∞–ø –Ω–∞ –∫–∞—Ä—Ç—É
5. –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Ä–æ–∑–±–∏—Ç—Ç—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –Ω–∞ —Å–µ–∫—Ü—ñ—ó
6. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –≤ Use Case
7. –†–æ–∑—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –¥–ª—è –∫–æ–∂–Ω–æ—ó —Å–µ–∫—Ü—ñ—ó –æ–∫—Ä–µ–º–æ

### –ï—Ç–∞–ø 3: –ù–æ–≤–∞ –ª–æ–≥—ñ–∫–∞ –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è
8. –ü–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ –ª–æ–≥—ñ–∫—É –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ `GestureDetector`
9. –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫ –≤—ñ–¥—Ä—ñ–∑–∫–∞ –ø—Ä–∏ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—ñ —Ç–æ—á–∫–∏ –Ω–∞ –¥–æ—Ä–æ–∑—ñ
10. –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –∫–∞—Å–∫–∞–¥–Ω–µ –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è
11. –î–æ–¥–∞—Ç–∏ –≥—Ä–∞–¥—ñ—î–Ω—Ç –∫–æ–ª—å–æ—Ä—É –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è

---

## üìä –û—Ü—ñ–Ω–∫–∞ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ

- **–í–∏—Å–æ–∫–∏–π —Ä—ñ–≤–µ–Ω—å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ:**
  - –ù–æ–≤–∞ –ª–æ–≥—ñ–∫–∞ –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è (–ø–æ–≤–Ω–∞ –ø–µ—Ä–µ—Ä–æ–±–∫–∞)
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Ä–æ–∑–±–∏—Ç—Ç—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –Ω–∞ —Å–µ–∫—Ü—ñ—ó
  - –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤—Å—ñ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Å–µ–∫—Ü—ñ—ó –≤ –æ–¥–Ω–æ–º—É –º—ñ—Å—Ü—ñ

- **–°–µ—Ä–µ–¥–Ω—ñ–π —Ä—ñ–≤–µ–Ω—å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ:**
  - –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö Use Cases —Ç–∞ —Å–µ—Ä–≤—ñ—Å—ñ–≤
  - –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ —ñ—Å–Ω—É—é—á–∏–º –∫–æ–¥–æ–º

- **–ù–∏–∑—å–∫–∏–π —Ä—ñ–≤–µ–Ω—å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ:**
  - –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–µ—Ä—à–æ–≥–æ —Ç–∞–ø—É
  - –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ –≥—Ä–∞–¥—ñ—î–Ω—Ç–æ–º –∫–æ–ª—å–æ—Ä—É
